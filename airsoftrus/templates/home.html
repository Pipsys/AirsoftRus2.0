{% extends "base.html" %}
{% load static %}

{% block title %}AirsoftRus 2.0 — Главная{% endblock %}

{% block content %}
<style>
    .feature-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        height: 100%;
    }
    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }
    .category-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
    }
    .news-card {
        border: none;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    .news-card img {
        transition: transform 0.5s ease;
    }
    .news-card:hover img {
        transform: scale(1.05);
    }
    .stats-item {
        background: rgba(var(--bs-body-bg-rgb), 0.1);
        backdrop-filter: blur(10px);
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
    }
    .stats-item:hover {
        background: rgba(var(--bs-body-bg-rgb), 0.2);
        transform: scale(1.05);
    }
    /* Слайдер: адаптация под тему */
    .carousel-caption {
        border-radius: 12px;
        padding: 20px;
        transition: background 0.3s, color 0.3s;
    }
    .theme-light .carousel-caption {
        background: rgba(255,255,255,0.85);
        color: #222;
    }
    .theme-dark .carousel-caption {
        background: rgba(30,30,30,0.85);
        color: #f5f5f7;
    }
    .theme-dark .carousel-caption a.btn,
    .theme-dark .carousel-caption .btn {
        border-color: #f5f5f7;
        color: #f5f5f7;
    }
    .theme-dark .carousel-caption a.btn:hover,
    .theme-dark .carousel-caption .btn:hover {
        background: #1c69d4;
        color: #fff;
        border-color: #1c69d4;
    }
    .testimonial-form {
        background: var(--bs-body-bg);
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    /* Адаптация карточек и секций под тёмную тему */
    .theme-dark .feature-card,
    .theme-dark .news-card,
    .theme-dark .card,
    .theme-dark .stats-item {
        background: #23272b !important;
        color: #f5f5f7 !important;
        border-color: #23272b !important;
    }
    .theme-dark .feature-card h3,
    .theme-dark .news-card h5,
    .theme-dark .card-title,
    .theme-dark .stats-item h3 {
        color: #f5f5f7 !important;
    }
    .theme-dark .category-badge {
        background: rgba(255,255,255,0.15);
        color: #fff;
    }
    .theme-dark .btn-outline-primary,
    .theme-dark .btn-outline-secondary {
        border-color: #f5f5f7;
        color: #f5f5f7;
    }
    .theme-dark .btn-outline-primary:hover,
    .theme-dark .btn-outline-secondary:hover {
        background: #1c69d4;
        color: #fff;
        border-color: #1c69d4;
    }
    .theme-dark .bg-body-tertiary,
    .theme-dark .bg-body-secondary {
        background: #181a1b !important;
    }
    .theme-dark .text-muted {
        color: #b0b0b0 !important;
    }
    .theme-dark .text-warning {
        color: #ffd600 !important;
    }
    .theme-dark .btn-light {
        background: #23272b;
        color: #f5f5f7;
        border-color: #f5f5f7;
    }
    .theme-dark .btn-light:hover {
        background: #1c69d4;
        color: #fff;
        border-color: #1c69d4;
    }
</style>

<!-- Главный слайдер -->
<div id="mainSlider" class="carousel slide mb-5" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#mainSlider" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Слайд 1"></button>
    <button type="button" data-bs-target="#mainSlider" data-bs-slide-to="1" aria-label="Слайд 2"></button>
    <button type="button" data-bs-target="#mainSlider" data-bs-slide-to="2" aria-label="Слайд 3"></button>
  </div>
  <div class="carousel-inner rounded-4 shadow-lg">
    <div class="carousel-item active">
      <img src="{% static 'slider/slide1.jpg' %}" class="d-block w-100" alt="AirsoftRus Магазин">
      <div class="carousel-caption">
        <h2 class="mb-2 display-4 fw-bold">AirsoftRus 2.0</h2>
        <p class="lead mb-0 fs-4">Лучший выбор страйкбольного оружия, экипировки и аксессуаров</p>
        <a href="#features" class="btn btn-outline-primary btn-lg mt-3">Узнать больше</a>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'slider/slide2.jpg' %}" class="d-block w-100" alt="Оружие и экипировка">
      <div class="carousel-caption">
        <h2 class="mb-2 display-4 fw-bold">Современное снаряжение</h2>
        <p class="lead mb-0 fs-4">Экипируйтесь на высшем уровне — новинки сезона и проверенные бренды</p>
        <a href="{% url 'shop:product_list' %}?category=equipment" class="btn btn-outline-primary btn-lg mt-3">Смотреть экипировку</a>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'slider/slide3.jpg' %}" class="d-block w-100" alt="Команда AirsoftRus">
      <div class="carousel-caption">
        <h2 class="mb-2 display-4 fw-bold">Команда профессионалов</h2>
        <p class="lead mb-0 fs-4">Профессиональная консультация и сервис для каждого клиента</p>
        <a href="#contacts" class="btn btn-outline-primary btn-lg mt-3">Контакты</a>
      </div>
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#mainSlider" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Назад</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#mainSlider" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Вперёд</span>
  </button>
</div>

<!-- Основное приветствие -->
<div class="container py-5 text-center">
    <h2 class="display-5 fw-bold mb-4">AirsoftRus — всё для страйкбола</h2>
    <p class="lead mb-4" style="max-width:800px;margin:auto;">
        Добро пожаловать в AirsoftRus 2.0! Мы предлагаем широкий ассортимент страйкбольного оружия, 
        снаряжения, защиты и аксессуаров от ведущих мировых производителей.
    </p>
    <div class="d-flex justify-content-center gap-3">
        <a href="{% url 'shop:product_list' %}" class="btn btn-primary btn-lg px-4">Перейти в каталог</a>
        <a href="#features" class="btn btn-outline-secondary btn-lg px-4">Наши преимущества</a>
    </div>
</div>

<!-- Преимущества -->
<section id="features" class="py-5 bg-body-tertiary">
    <div class="container">
        <h2 class="text-center mb-5 display-6 fw-bold">Почему выбирают нас</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card feature-card h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <img src="{% static 'icons/shield-check.svg' %}" width="48" height="48" alt="Гарантия">
                        </div>
                        <h3 class="h4">Гарантия качества</h3>
                        <p>Все товары проходят тщательную проверку перед отправкой. Гарантия от 6 месяцев на все продукты.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <img src="{% static 'icons/truck.svg' %}" width="48" height="48" alt="Доставка">
                        </div>
                        <h3 class="h4">Быстрая доставка</h3>
                        <p>Доставка по всей России от 1 дня. Самовывоз из 15 пунктов в Москве и Санкт-Петербурге.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <img src="{% static 'icons/headset.svg' %}" width="48" height="48" alt="Поддержка">
                        </div>
                        <h3 class="h4">Экспертная поддержка</h3>
                        <p>Наши специалисты с опытом от 5 лет помогут с выбором и ответят на все вопросы.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Популярные товары -->
<section class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="display-6 fw-bold mb-0">Популярные товары</h2>
            <a href="{% url 'shop:product_list' %}" class="btn btn-outline-primary">Все товары</a>
        </div>
        <div class="row g-4">
            {% for product in popular_products %}
            <div class="col-md-3">
                <div class="card h-100 shadow-sm position-relative">
                    <span class="category-badge">{{ product.category.name }}</span>
                    <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}" style="height: 200px; object-fit: cover;">
                    <div class="card-body">
                        <h5 class="card-title">{{ product.name }}</h5>
                        <p class="card-text text-muted">{{ product.short_description }}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-bold">{{ product.price }} ₽</span>
                            <a href="{{ product.get_absolute_url }}" class="btn btn-sm btn-outline-primary">Подробнее</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Статистика -->
<section class="py-5 bg-body-secondary">
    <div class="container">
        <div class="row g-4 text-center">
            <div class="col-md-3">
                <div class="stats-item">
                    <h3 class="display-4 fw-bold">10+</h3>
                    <p class="mb-0">Лет на рынке</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-item">
                    <h3 class="display-4 fw-bold">5000+</h3>
                    <p class="mb-0">Довольных клиентов</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-item">
                    <h3 class="display-4 fw-bold">200+</h3>
                    <p class="mb-0">Брендов в каталоге</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-item">
                    <h3 class="display-4 fw-bold">24/7</h3>
                    <p class="mb-0">Поддержка клиентов</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Новости и события -->
<section class="py-5">
    <div class="container">
        <h2 class="text-center mb-5 display-6 fw-bold">Новости и события</h2>
        <div class="row g-4">
            {% for news in latest_news %}
            <div class="col-md-4">
                <div class="card news-card h-100 shadow-sm">
                    <img src="{{ news.image.url }}" class="card-img-top" alt="{{ news.title }}" style="height: 200px; object-fit: cover;">
                    <div class="card-body">
                        <small class="text-muted">{{ news.published_date|date:"d.m.Y" }}</small>
                        <h5 class="card-title mt-2">{{ news.title }}</h5>
                        <p class="card-text">{{ news.excerpt }}</p>
                        <a href="{% url 'news_detail' news.slug %}" class="btn btn-sm btn-outline-primary">Читать далее</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Отзывы -->
<section class="py-5 bg-body-tertiary">
    <div class="container">
        <h2 class="text-center mb-5 display-6 fw-bold">Отзывы наших клиентов</h2>
        <div class="row g-4">
            <!-- Фейковые отзывы -->
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="{% static 'avatars/avatar1.jpg' %}" class="rounded-circle me-3" width="50" height="50" alt="Иван Петров">
                            <div>
                                <h6 class="mb-0">Иван Петров</h6>
                                <small class="text-muted">15.05.2025</small>
                            </div>
                        </div>
                        <p class="card-text">"Отличный магазин! Заказал винтовку, пришла быстро, упакована идеально. Работает без нареканий. Обслуживание на высшем уровне!"</p>
                        <div class="text-warning">
                            ★ ★ ★ ★ ★
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="{% static 'avatars/avatar2.jpg' %}" class="rounded-circle me-3" width="50" height="50" alt="Алексей Смирнов">
                            <div>
                                <h6 class="mb-0">Алексей Смирнов</h6>
                                <small class="text-muted">22.04.2025</small>
                            </div>
                        </div>
                        <p class="card-text">"Покупаю здесь уже третий год подряд. Всегда качественный товар и профессиональные консультации. Особенно радует система бонусов для постоянных клиентов."</p>
                        <div class="text-warning">
                            ★ ★ ★ ★ ☆
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="{% static 'avatars/avatar3.jpg' %}" class="rounded-circle me-3" width="50" height="50" alt="Екатерина Иванова">
                            <div>
                                <h6 class="mb-0">Екатерина Иванова</h6>
                                <small class="text-muted">03.05.2025</small>
                            </div>
                        </div>
                        <p class="card-text">"Заказывала подарок мужу на день рождения. Помогли с выбором, подобрали оптимальный вариант по характеристикам и цене. Муж в восторге!"</p>
                        <div class="text-warning">
                            ★ ★ ★ ★ ★
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Реальные отзывы из базы данных -->
            {% for review in testimonials %}
            <div class="col-md-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <img src="{{ review.user.profile.avatar.url }}" class="rounded-circle me-3" width="50" height="50" alt="{{ review.user.get_full_name }}">
                            <div>
                                <h6 class="mb-0">{{ review.user.get_full_name }}</h6>
                                <small class="text-muted">{{ review.created_at|date:"d.m.Y" }}</small>
                            </div>
                        </div>
                        <p class="card-text">"{{ review.text }}"</p>
                        <div class="text-warning">
                            {% for i in "12345" %}
                                {% if forloop.counter <= review.rating %}
                                    ★
                                {% else %}
                                    ☆
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        

    </div>
</section>

<!-- CTA секция -->
<section class="py-5 bg-primary text-white">
    <div class="container text-center">
        <h2 class="display-5 fw-bold mb-4">Готовы начать?</h2>
        <p class="lead mb-4" style="max-width:700px;margin:auto;">
            Присоединяйтесь к тысячам довольных клиентов AirsoftRus 2.0
        </p>
        <div class="d-flex justify-content-center gap-3">
            <a href="{% url 'shop:product_list' %}" class="btn btn-light btn-lg px-4">Перейти в каталог</a>
            <a href="#contacts" class="btn btn-outline-light btn-lg px-4">Консультация</a>
        </div>
    </div>
</section>
{% endblock %}